<!DOCTYPE html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>Friend Finder</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css" integrity="sha384-9gVQ4dYFwwWSjIDZnLEWnxCjeSWFphJiwGPXr1jddIhOegiu1FwO5qRGvFXOdJZ4" crossorigin="anonymous">
        <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
    </head>
    <body>
        <section class="container" id="body">
            <section class="container" id="header">  
                <h2>Friend Finder Survey</h2>
                <p>From the dropdown under each statement select how much you agree with the statement.  Your possible answers are numeric from one to five, with one indicating strongly disagree, three indicating neutral, and five indicating strongly agree.  Have fun and get matching!</p>
            </section>
            <hr>
            <section class="container" id="inputs">
               <h2>About You</h2>
               <br>
               <h4>Name (Required)</h4>
                <div class="input-group mb-3">
                    <input type="text" class="form-control" id='name' aria-label="Default" aria-describedby="inputGroup-sizing-default">
                </div>
                <br>
                <h4>Link to Photo Image (Required)</h4>
                <div class="input-group mb-3">
                    <input type="text" class="form-control" id='picture' aria-label="Default" aria-describedby="inputGroup-sizing-default">
                </div>
            </section>
            <hr>
            <section class="container" id="quiz">
                <section class= "questions">
                    <h4>Question 1</h4>
                    <p>I want to be famous.</p>
                    <div class="input-group mb-3 dropdownMenuButton">
                        <select class="custom-select" id="q1">
                          <option selected>Select an Option</option>
                          <option value="1" >1 Strongly Disagree </option>
                          <option value="2" >2</option>
                          <option value="3" >3 Neutral</option>
                          <option value="4" >4</option>
                          <option value="5" >5 Strongly Agree</option>
                        </select>
                    </div>
                </section>
                <br>
                <section class= "questions">
                    <h4>Question 2</h4>
                    <p>I often feel grateful for all I have in life.</p>
                    <div class="input-group mb-3 dropdownMenuButton">
                        <select class="custom-select" id="q2">
                          <option selected>Select an Option</option>
                          <option value="1" >1 Strongly Disagree </option>
                          <option value="2" >2</option>
                          <option value="3" >3 Neutral</option>
                          <option value="4" >4</option>
                          <option value="5" >5 Strongly Agree</option>
                        </select>
                    </div>
                </section>
                <br>
                <section class= "questions">
                    <h4>Question 3</h4>
                    <p>I feel like I have made many accomplishments in life.</p>
                    <div class="input-group mb-3 dropdownMenuButton">
                        <select class="custom-select" id="q3">
                          <option selected>Select an Option</option>
                          <option value="1" >1 Strongly Disagree </option>
                          <option value="2" >2</option>
                          <option value="3" >3 Neutral</option>
                          <option value="4" >4</option>
                          <option value="5" >5 Strongly Agree</option>
                        </select>
                    </div>
                </section>
                <br>
                <section class= "questions">
                    <h4>Question 4</h4>
                    <p>I would prefer a few close friends to many aquaintences.</p>
                    <div class="input-group mb-3 dropdownMenuButton">
                        <select class="custom-select" id="q4">
                          <option selected>Select an Option</option>
                          <option value="1" >1 Strongly Disagree </option>
                          <option value="2" >2</option>
                          <option value="3" >3 Neutral</option>
                          <option value="4" >4</option>
                          <option value="5" >5 Strongly Agree</option>
                        </select>
                    </div>
                </section>
                <br>
                <section class= "questions">
                    <h4>Question 5</h4>
                    <p>I prefer to be serious over joking around.</p>
                    <div class="input-group mb-3 dropdownMenuButton">
                        <select class="custom-select" id="q5">
                          <option selected>Select an Option</option>
                          <option value="1" >1 Strongly Disagree </option>
                          <option value="2" >2</option>
                          <option value="3" >3 Neutral</option>
                          <option value="4" >4</option>
                          <option value="5" >5 Strongly Agree</option>
                        </select>
                    </div>
                </section>
                <br>
                <section class= "questions">
                    <h4>Question 6</h4>
                    <p>I enjoy taking opportunities to better myself.</p>
                    <div class="input-group mb-3 dropdownMenuButton">
                        <select class="custom-select" id="q6">
                          <option selected>Select an Option</option>
                          <option value="1" >1 Strongly Disagree </option>
                          <option value="2" >2</option>
                          <option value="3" >3 Neutral</option>
                          <option value="4" >4</option>
                          <option value="5" >5 Strongly Agree</option>
                        </select>
                    </div>
                </section>
                <br>
                <section class= "questions">
                    <h4>Question 7</h4>
                    <p>I enjoy striking conversation with random people.</p>
                    <div class="input-group mb-3 dropdownMenuButton">
                        <select class="custom-select" id="q7">
                          <option selected>Select an Option</option>
                          <option value="1" >1 Strongly Disagree </option>
                          <option value="2" >2</option>
                          <option value="3" >3 Neutral</option>
                          <option value="4" >4</option>
                          <option value="5" >5 Strongly Agree</option>
                        </select>
                    </div>
                </section>
                <br>
                <section class= "questions">
                    <h4>Question 8</h4>
                    <p>I prefer to play it safe rather than take risks.</p>
                    <div class="input-group mb-3 dropdownMenuButton">
                        <select class="custom-select" id="q8">
                          <option selected>Select an Option</option>
                          <option value="1" >1 Strongly Disagree </option>
                          <option value="2" >2</option>
                          <option value="3" >3 Neutral</option>
                          <option value="4" >4</option>
                          <option value="5" >5 Strongly Agree</option>
                        </select>
                    </div>
                </section>
                <br>
                <section class= "questions">
                    <h4>Question 9</h4>
                    <p>I prefer to be alone rather than around people.</p>
                    <div class="input-group mb-3 dropdownMenuButton">
                        <select class="custom-select" id="q9">
                          <option selected>Select an Option</option>
                          <option value="1" >1 Strongly Disagree </option>
                          <option value="2" >2</option>
                          <option value="3" >3 Neutral</option>
                          <option value="4" >4</option>
                          <option value="5" >5 Strongly Agree</option>
                        </select>
                    </div>
                </section>
                <br>
                <section class= "questions">
                    <h4>Question 10</h4>
                    <p>Every day is full of new opportunities.</p>
                    <div class="input-group mb-3 dropdownMenuButton" >
                        <select class="custom-select" id="q10">
                          <option selected value="Select an Option">Select an Option</option>
                          <option value="1" >1 Strongly Disagree </option>
                          <option value="2" >2</option>
                          <option value="3" >3 Neutral</option>
                          <option value="4" >4</option>
                          <option value="5" >5 Strongly Agree</option>
                        </select>
                    </div>
                </section>
            </section>
            <br>
            <section class="container">
                <button type="button" class="btn btn-primary btn-lg btn-block" id="subButton">Submit</button>
            </section>
            <div class="modal" tabindex="-1" role="dialog" id="bestFriendModal">
                <div class="modal-dialog" role="document">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h3 class="modal-title"></h3>
                      <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                      </button>
                    </div>
                    <div class="modal-body">
                      <p id="friendname"></p>
                      <img id='friendPic'>
                    <div class="modal-footer">
                      <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    </div>
                  </div>
                </div>
              </div>
        </section>
        <!-- <script type="text/javascript" src="../data/friends.js"></script> -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js"                     integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ" crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js" integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm" crossorigin="anonymous"></script>
        <script type="text/javascript">
            
            $("#subButton").on("click", function() {
                event.preventDefault();
                function validation() {
                    let validated = true;
                    $(".form-control").each(function() {
                    if ($(this).val() === "") {
                        validated = false;
                    }
                    });
                    $(".custom-select").each(function() {
                    if ($(this).val() === "") {
                        validated = false;
                    }
                    });
                    return validated;
                }

                if (validation()) {
                    let answers = [($('#q1').val()), $('#q2').val(), $('#q3').val(), $('#q4').val(), $('#q5').val(), $('#q6').val(), $('#q7').val(), $('#q8').val(), $('#q9').val(), $('#q10').val()];
                    let newUser = {
                        name: $('#name').val().trim(),
                        picture: $('#picture').val().trim(),
                        scores: answers 
                    }
                    // console.log(newUser);
                    $.ajax({
                        method: "POST",
                        url: "/api/friends",
                        data: newUser,
                        type: 'application/json',
                        success: function(response) {
                            console.log(response);
                            var friendPic = response.bestFriend.photo;
                            $('.modal-title').text('Great!! Your match is...')
                            $("#friendname").text(response.bestFriend.name);
                            $("#friendPic").attr("src", response.bestFriend.photo);
                            // $('#friendPic').html('<img src="' + response.bestFriend.photo + '">')
                            $('#bestFriendModal').modal('toggle');
                            console.log('<img src="' + response.bestFriend.photo + '">');
                            
                        }
                    });
                } else {
                    $('.modal-title').text("Hmmm....there was an error");
                    $(".modal-body").text("Please fill out all fields before submitting.");
                    $('#bestFriendModal').modal('show');
                }

                reset();
                
            });
            function reset() {
                $("#name").val('');
                $('#picture').val('');
                $("select").each(function() { 
                    this.selectedIndex = 0 });
                };

        </script>
    </body>
</html>